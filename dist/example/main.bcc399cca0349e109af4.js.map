{"version":3,"sources":["webpack:///main.bcc399cca0349e109af4.js","webpack:///./src/kami/node.js","webpack:///./src/kami/config.js","webpack:///./src/example/grids.js","webpack:///./src/example/index.js","webpack:///./src/kami/index.js","webpack:///./src/kami/kami-extend.js","webpack:///./src/kami/kami-core.js"],"names":["webpackJsonp","128","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","undefined","_set","_set2","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","Node","type","this","color","line","_linkNodes","key","_this","_len","arguments","length","nodes","Array","_key","filter","node","forEach","has","add","_this2","_len2","_key2","delete","129","defaultLines","1","2","3","4","5","6","defaultColors","130","grids","steps","65","initPage","_grids2","gridsIndex","kami","_kami2","canvasContainerEl","document","querySelector","colorsContainerEl","tipContainerEl","innerHTML","types","colors","lines","curType","colorsEl","slice","call","querySelectorAll","el","addEventListener","e","classList","remove","dataset","click","canvasEl","getNodeByOffset","offsetX","offsetWidth","offsetY","offsetHeight","tap","onEnd","_ref","result","tapCount","alert","reset","delay","mount","_kami","_grids","66","_kamiExtend","_kamiExtend2","67","_typeof2","_typeof3","_getPrototypeOf","_getPrototypeOf2","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_kamiCore","_kamiCore2","Kami","_KamiCore","__proto__","apply","canvas","_canvas","setStyles","render","_ref2","nodeGrids","row","canvasWidth","width","canvasHeight","height","ctx","getContext","gridXLen","gridYLen","nodeWidth","nodeHeight","clearRect","rowData","y","x","reverse","beginPath","moveTo","lineTo","fillStyle","fill","strokeStyle","stroke","closePath","percentX","percentY","areaWidth","areaHeight","areaX","areaOffsetXPercent","areaY","areaOffsetYPercent","isUpHalf","99","initData","nodeTypeMap","_originGrids","map","nodeType","_node2","_defineProperties2","getNode","enumerable","link","_tapCount","_keys2","typeStr","_class","_temp","_getIterator2","_getIterator3","_weakSet","_weakSet2","_keys","_defineProperties","_node","_config","KamiCore","_ref$canvas","_ref$colors","_ref$lines","Error","targetType","originalType","traveledNodes","spread","nextNodes","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","next","done","linkNode","err","return","size","setTimeout","checkConsistency","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3"],"mappings":"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","file":"main.bcc399cca0349e109af4.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ 128:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = undefined;\n\nvar _set = __webpack_require__(60);\n\nvar _set2 = _interopRequireDefault(_set);\n\nvar _classCallCheck2 = __webpack_require__(40);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(41);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Node = function () {\n    function Node(type) {\n        (0, _classCallCheck3.default)(this, Node);\n\n        this.type = type;\n        this.color = '';\n        this.line = '';\n        this._linkNodes = new _set2.default();\n    }\n\n    (0, _createClass3.default)(Node, [{\n        key: 'link',\n        value: function link() {\n            var _this = this;\n\n            if (!this.type) return;\n\n            for (var _len = arguments.length, nodes = Array(_len), _key = 0; _key < _len; _key++) {\n                nodes[_key] = arguments[_key];\n            }\n\n            nodes.filter(function (node) {\n                return node && node instanceof Node && node.type;\n            }).forEach(function (node) {\n                if (_this._linkNodes.has(node)) return; // if node already linked, do nothing\n                _this._linkNodes.add(node);\n                node._linkNodes.add(_this);\n            });\n        }\n    }, {\n        key: 'unlink',\n        value: function unlink() {\n            var _this2 = this;\n\n            for (var _len2 = arguments.length, nodes = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                nodes[_key2] = arguments[_key2];\n            }\n\n            nodes.filter(function (node) {\n                return node && node instanceof Node && node.type;\n            }).forEach(function (node) {\n                _this2._linkNodes.delete(node);\n                node._linkNodes.delete(_this2);\n            });\n        }\n    }]);\n    return Node;\n}();\n\nexports.default = Node;\n\n/***/ }),\n\n/***/ 129:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar defaultLines = exports.defaultLines = {\n    '1': 'rgba(205,150,112,.15)',\n    '2': 'rgba(190,112,34,.15)',\n    '3': 'rgba(190,133,84,.15)',\n    '4': 'rgba(140,90,5,.15)',\n    '5': 'rgba(120,80,36,.15)',\n    '6': 'rgba(202,129,60,.15)'\n};\n\nvar defaultColors = exports.defaultColors = {\n    '1': 'rgba(255,186,132,1)',\n    '2': 'rgba(233,139,42,1)',\n    '3': 'rgba(233,163,104,1)',\n    '4': 'rgba(177,120,6,1)',\n    '5': 'rgba(150,99,46,1)',\n    '6': 'rgba(252,159,77,1)'\n};\n\n/***/ }),\n\n/***/ 130:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = [{\n    grids: [[1, 1, 3, 1, 1, 2, 1, 1, 1, 1], [1, 1, 3, 1, 0, 1, 1, 1, 1, 1], [1, 1, 3, 0, 0, 0, 1, 1, 1, 1], [1, 1, 1, 1, 0, 0, 1, 1, 1, 1], [1, 1, 1, 1, 2, 2, 2, 4, 4, 1], [1, 1, 1, 1, 1, 2, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 2, 2, 2, 1, 1, 1], [1, 1, 1, 1, 1, 2, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1]],\n    steps: 6\n}, {\n    grids: [[1, 1, 1, 3, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 3, 3, 1, 1, 1, 1, 1, 1, 1], [3, 1, 3, 1, 1, 1, 2, 1, 1, 1], [1, 1, 1, 1, 1, 2, 2, 1, 1, 1], [1, 1, 3, 1, 2, 2, 2, 1, 1, 1], [1, 1, 3, 1, 1, 2, 1, 1, 1, 1], [1, 1, 3, 0, 0, 1, 1, 1, 1, 1], [1, 1, 3, 0, 0, 0, 1, 1, 1, 1], [1, 1, 1, 1, 0, 0, 1, 1, 1, 1], [1, 1, 1, 1, 2, 2, 2, 4, 4, 1], [1, 1, 1, 1, 1, 2, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 2, 2, 2, 1, 1, 1], [1, 1, 1, 1, 1, 2, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 6, 6, 1, 1, 1], [1, 1, 3, 5, 5, 5, 5, 1, 1, 1], [1, 1, 1, 1, 1, 6, 6, 1, 1, 1]],\n    steps: 5\n}];\n\n/***/ }),\n\n/***/ 65:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _kami = __webpack_require__(66);\n\nvar _kami2 = _interopRequireDefault(_kami);\n\nvar _grids = __webpack_require__(130);\n\nvar _grids2 = _interopRequireDefault(_grids);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// const Kami = require('../kami');\nvar gridsIndex = 0;\n\nfunction initPage() {\n    var grids = _grids2.default[gridsIndex].grids;\n    var steps = _grids2.default[gridsIndex].steps;\n\n    var kami = new _kami2.default({\n        grids: grids\n    });\n\n    var canvasContainerEl = document.querySelector('#canvas-wrapper');\n    var colorsContainerEl = document.querySelector('#colors-wrapper');\n    var tipContainerEl = document.querySelector('#tips-wrapper');\n\n    canvasContainerEl.innerHTML = '<canvas width=\"300\" height=\"400\"></canvas>';\n\n    colorsContainerEl.innerHTML = '';\n    kami.types.forEach(function (type) {\n        colorsContainerEl.innerHTML += '<span\\n            data-type=\"' + type + '\" \\n            class=\"color\"\\n            style=\"background: ' + kami.colors[type] + '; border: 3px solid ' + kami.lines[type] + '\"\\n        ></span>';\n    });\n\n    tipContainerEl.innerHTML = '<div>\\u8BF7\\u5728' + steps + '\\u6B65\\u4E4B\\u5185\\u5B8C\\u6210</div>';\n\n    var curType = void 0;\n    var colorsEl = [].slice.call(colorsContainerEl.querySelectorAll('[data-type]'));\n    colorsEl.forEach(function (el) {\n        el.addEventListener('click', function (e) {\n            colorsEl.forEach(function (el) {\n                el.classList.remove('selected');\n            });\n            this.classList.add('selected');\n            curType = +this.dataset.type;\n        });\n    });\n    colorsContainerEl.querySelector('[data-type]').click();\n\n    var canvasEl = canvasContainerEl.querySelector('canvas');\n\n    canvasEl.addEventListener('click', function (e) {\n\n        var node = kami.getNodeByOffset(e.offsetX / canvasEl.offsetWidth, e.offsetY / canvasEl.offsetHeight);\n        kami.tap(node, curType, {\n            onEnd: function onEnd(_ref) {\n                var result = _ref.result,\n                    tapCount = _ref.tapCount;\n\n                if (result) {\n                    gridsIndex++;\n                    if (gridsIndex >= _grids2.default.length) {\n                        alert('\\u5DF2\\u5B8C\\u6210\\u6240\\u6709');\n                        return;\n                    }\n                    alert('\\u5B8C\\u6210');\n                    initPage();\n                } else if (tapCount > steps) {\n                    alert('\\u5931\\u8D25');\n                    kami.reset();\n                }\n            },\n\n            delay: 100\n        });\n    });\n\n    kami.mount(canvasEl);\n}\n\ninitPage();\n\n/***/ }),\n\n/***/ 66:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _kamiExtend = __webpack_require__(67);\n\nvar _kamiExtend2 = _interopRequireDefault(_kamiExtend);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _kamiExtend2.default;\n\n/***/ }),\n\n/***/ 67:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = undefined;\n\nvar _typeof2 = __webpack_require__(24);\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nvar _getPrototypeOf = __webpack_require__(84);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(40);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(41);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(90);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(91);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _kamiCore = __webpack_require__(99);\n\nvar _kamiCore2 = _interopRequireDefault(_kamiCore);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Kami = function (_KamiCore) {\n    (0, _inherits3.default)(Kami, _KamiCore);\n\n    function Kami() {\n        (0, _classCallCheck3.default)(this, Kami);\n        return (0, _possibleConstructorReturn3.default)(this, (Kami.__proto__ || (0, _getPrototypeOf2.default)(Kami)).apply(this, arguments));\n    }\n\n    (0, _createClass3.default)(Kami, [{\n        key: 'mount',\n\n        // 挂载到canvas并自动渲染\n        value: function mount(canvas) {\n            var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n                colors = _ref.colors,\n                lines = _ref.lines;\n\n            this._canvas = canvas;\n            colors = colors || this.colors || Kami.defaultColors;\n            lines = lines || this.lines || Kami.defaultLines;\n            this.setStyles({ colors: colors, lines: lines });\n            this.render();\n        }\n\n        // 改变节点样式\n\n    }, {\n        key: 'setStyles',\n        value: function setStyles(_ref2) {\n            var _this2 = this;\n\n            var node = _ref2.node,\n                colors = _ref2.colors,\n                lines = _ref2.lines;\n\n            this.colors = colors || this.colors;\n            this.lines = lines || this.lines;\n            if (node) {\n                node.color = this.colors[node.type] || '';\n                node.line = (0, _typeof3.default)(this.lines) === 'object' ? this.lines[node.type] : node.type ? this.lines : '';\n            } else {\n                this.nodeGrids.forEach(function (row) {\n                    row.forEach(function (node) {\n                        node.color = _this2.colors[node.type] || '';\n                        node.line = (0, _typeof3.default)(_this2.lines) === 'object' ? _this2.lines[node.type] : node.type ? _this2.lines : '';\n                    });\n                });\n            }\n        }\n\n        // 渲染到canvas\n\n    }, {\n        key: 'render',\n        value: function render() {\n            if (!this._canvas) return;\n            var nodeGrids = this.nodeGrids,\n                _canvas = this._canvas;\n\n\n            var canvasWidth = _canvas.width;\n            var canvasHeight = _canvas.height;\n            var ctx = _canvas.getContext('2d');\n            var gridXLen = nodeGrids[0].length;\n            var gridYLen = nodeGrids.length;\n            var nodeWidth = canvasWidth / gridXLen;\n            var nodeHeight = canvasHeight / ((gridYLen - 1) / 2) / 2;\n            ctx.clearRect(0, 0, canvasWidth, canvasHeight);\n            nodeGrids.forEach(function (rowData, y) {\n                rowData.forEach(function (node, x) {\n                    var reverse = x + y & 1;\n                    ctx.beginPath();\n                    if (!reverse) {\n                        ctx.moveTo(nodeWidth * x, nodeHeight * (y - 1));\n                        ctx.lineTo(nodeWidth * (x + 1), nodeHeight * y);\n                        ctx.lineTo(nodeWidth * x, nodeHeight * (y + 1));\n                        ctx.lineTo(nodeWidth * x, nodeHeight * (y - 1));\n                    } else {\n                        ctx.moveTo(nodeWidth * x, nodeHeight * y);\n                        ctx.lineTo(nodeWidth * (x + 1), nodeHeight * (y - 1));\n                        ctx.lineTo(nodeWidth * (x + 1), nodeHeight * (y + 1));\n                        ctx.lineTo(nodeWidth * x, nodeHeight * y);\n                    }\n\n                    ctx.fillStyle = node.color;\n                    node.color && ctx.fill();\n                    ctx.strokeStyle = node.line;\n                    node.line && ctx.stroke();\n                    ctx.closePath();\n                });\n            });\n        }\n\n        // 根据坐标获取节点\n\n    }, {\n        key: 'getNodeByOffset',\n        value: function getNodeByOffset(percentX, percentY) {\n            var areaWidth = 1 / this.nodeGrids[0].length;\n            var areaHeight = 1 / (this.nodeGrids.length - 1);\n\n            var areaX = percentX / areaWidth | 0;\n            var areaOffsetXPercent = percentX / areaWidth - areaX;\n            var areaY = percentY / areaHeight | 0;\n            var areaOffsetYPercent = 1 - (percentY / areaHeight - areaY);\n\n            var isUpHalf = areaX + areaY & 1 ? 1 - areaOffsetXPercent < areaOffsetYPercent : areaOffsetXPercent < areaOffsetYPercent;\n\n            var x = areaX;\n            var y = isUpHalf ? areaY : areaY + 1;\n            return this.nodeGrids[y][x];\n        }\n    }]);\n    return Kami;\n}(_kamiCore2.default);\n\nexports.default = Kami;\n\n\nmodule.exports = Kami;\n\n/***/ }),\n\n/***/ 99:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = undefined;\n\nvar _getIterator2 = __webpack_require__(100);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _set = __webpack_require__(60);\n\nvar _set2 = _interopRequireDefault(_set);\n\nvar _weakSet = __webpack_require__(116);\n\nvar _weakSet2 = _interopRequireDefault(_weakSet);\n\nvar _classCallCheck2 = __webpack_require__(40);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(41);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _keys = __webpack_require__(122);\n\nvar _keys2 = _interopRequireDefault(_keys);\n\nvar _defineProperties = __webpack_require__(125);\n\nvar _defineProperties2 = _interopRequireDefault(_defineProperties);\n\nvar _class, _temp;\n\nvar _node = __webpack_require__(128);\n\nvar _node2 = _interopRequireDefault(_node);\n\nvar _config = __webpack_require__(129);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction initData() {\n    var nodeTypeMap = {};\n    var nodeGrids = this._originGrids.map(function (row) {\n        return row.map(function (nodeType) {\n            nodeTypeMap[nodeType] = true;\n            return new _node2.default(nodeType);\n        });\n    });\n\n    (0, _defineProperties2.default)(nodeGrids, {\n        getNode: {\n            value: function value(x, y) {\n                return this[y] && this[y][x] || null;\n            },\n\n            enumerable: false\n        }\n    });\n\n    // 处理各节点的链接关系\n    nodeGrids.forEach(function (row, y) {\n        row.forEach(function (node, x) {\n            node.link(nodeGrids.getNode(x, y - 1), nodeGrids.getNode(x, y + 1), nodeGrids.getNode(x + (x + y & 1 ? 1 : -1), y));\n        });\n    });\n\n    this.nodeGrids = nodeGrids;\n    this._tapCount = 0;\n    this.types = (0, _keys2.default)(nodeTypeMap).map(function (typeStr) {\n        return +typeStr;\n    }).filter(function (type) {\n        return type;\n    });\n\n    if (this._canvas) {\n        typeof this.mount === 'function' && this.mount(this._canvas);\n    }\n}\n\nvar KamiCore = (_temp = _class = function () {\n    function KamiCore() {\n        var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n            _ref$canvas = _ref.canvas,\n            canvas = _ref$canvas === undefined ? null : _ref$canvas,\n            grids = _ref.grids,\n            _ref$colors = _ref.colors,\n            colors = _ref$colors === undefined ? KamiCore.defaultColors : _ref$colors,\n            _ref$lines = _ref.lines,\n            lines = _ref$lines === undefined ? KamiCore.defaultLines : _ref$lines;\n\n        (0, _classCallCheck3.default)(this, KamiCore);\n\n        if (!grids || !grids[0]) {\n            throw new Error('please use correct grids');\n        }\n\n        this._originGrids = grids;\n        this._canvas = canvas;\n        this.colors = colors;\n        this.lines = lines;\n        initData.call(this);\n    }\n\n    (0, _createClass3.default)(KamiCore, [{\n        key: 'tap',\n\n\n        // 触发某节点的改变\n        value: function tap(node, targetType) {\n            var _this = this;\n\n            var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n                delay = _ref2.delay,\n                onEnd = _ref2.onEnd;\n\n            var originalType = node.type;\n            if (targetType === originalType) return;\n\n            this._tapCount++;\n            var traveledNodes = new _weakSet2.default(); // 已遍历过的节点\n            var nodes = new _set2.default([node]); // 需要处理的当前层节点\n\n            // 以BFS算法遍历各节点进行处理\n            var spread = function spread() {\n                var nextNodes = new _set2.default();\n                nodes.forEach(function (node) {\n                    traveledNodes.add(node);\n                    node.type = targetType;\n                    typeof _this.setStyles === 'function' && _this.setStyles({ node: node });\n                    var _iteratorNormalCompletion = true;\n                    var _didIteratorError = false;\n                    var _iteratorError = undefined;\n\n                    try {\n                        for (var _iterator = (0, _getIterator3.default)(node._linkNodes), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                            var linkNode = _step.value;\n\n                            if (!traveledNodes.has(linkNode) && linkNode.type === originalType) {\n                                nextNodes.add(linkNode);\n                            }\n                        }\n                    } catch (err) {\n                        _didIteratorError = true;\n                        _iteratorError = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion && _iterator.return) {\n                                _iterator.return();\n                            }\n                        } finally {\n                            if (_didIteratorError) {\n                                throw _iteratorError;\n                            }\n                        }\n                    }\n                });\n                nodes = nextNodes;\n                if (nodes.size) {\n                    if (delay) {\n                        delay = delay / 10 * 9;\n                        typeof _this.render === 'function' && _this.render();\n                        setTimeout(spread, delay);\n                    } else {\n                        spread();\n                    }\n                } else {\n                    typeof _this.render === 'function' && _this.render();\n                    onEnd && onEnd({\n                        result: _this.checkConsistency(),\n                        tapCount: _this._tapCount\n                    });\n                }\n            };\n            spread();\n        }\n    }, {\n        key: 'reset',\n        value: function reset() {\n            initData.call(this);\n        }\n\n        // 检查结果\n\n    }, {\n        key: 'checkConsistency',\n        value: function checkConsistency() {\n            var type = void 0;\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = (0, _getIterator3.default)(this.nodeGrids), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var row = _step2.value;\n                    var _iteratorNormalCompletion3 = true;\n                    var _didIteratorError3 = false;\n                    var _iteratorError3 = undefined;\n\n                    try {\n                        for (var _iterator3 = (0, _getIterator3.default)(row), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                            var node = _step3.value;\n\n                            if (!type) type = node.type;\n                            if (node.type && node.type !== type) return false;\n                        }\n                    } catch (err) {\n                        _didIteratorError3 = true;\n                        _iteratorError3 = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                                _iterator3.return();\n                            }\n                        } finally {\n                            if (_didIteratorError3) {\n                                throw _iteratorError3;\n                            }\n                        }\n                    }\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n\n            return true;\n        }\n    }]);\n    return KamiCore;\n}(), _class.defaultLines = _config.defaultLines, _class.defaultColors = _config.defaultColors, _temp);\nexports.default = KamiCore;\n\n\nmodule.exports = KamiCore;\n\n/***/ })\n\n},[65]);\n\n\n// WEBPACK FOOTER //\n// main.bcc399cca0349e109af4.js","export default class Node {\r\n    constructor (type) {\r\n        this.type = type;\r\n        this.color = '';\r\n        this.line = '';\r\n        this._linkNodes = new Set();\r\n    }\r\n\r\n    link (...nodes) {\r\n        if (!this.type) return;\r\n        nodes.filter(node => node && node instanceof Node && node.type).forEach(node => {\r\n            if (this._linkNodes.has(node)) return; // if node already linked, do nothing\r\n            this._linkNodes.add(node);\r\n            node._linkNodes.add(this);\r\n        });\r\n    }\r\n\r\n    unlink (...nodes) {\r\n        nodes.filter(node => node && node instanceof Node && node.type).forEach(node => {\r\n            this._linkNodes.delete(node);\r\n            node._linkNodes.delete(this);\r\n        });\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/kami/node.js","export const defaultLines = {\r\n    '1': 'rgba(205,150,112,.15)',\r\n    '2': 'rgba(190,112,34,.15)',\r\n    '3': 'rgba(190,133,84,.15)',\r\n    '4': 'rgba(140,90,5,.15)',\r\n    '5': 'rgba(120,80,36,.15)',\r\n    '6': 'rgba(202,129,60,.15)',\r\n};\r\n\r\nexport const defaultColors = {\r\n    '1': 'rgba(255,186,132,1)',\r\n    '2': 'rgba(233,139,42,1)',\r\n    '3': 'rgba(233,163,104,1)',\r\n    '4': 'rgba(177,120,6,1)',\r\n    '5': 'rgba(150,99,46,1)',\r\n    '6': 'rgba(252,159,77,1)',\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/kami/config.js","\r\nexport default   [\r\n    {\r\n        grids: [\r\n                [1, 1, 3, 1, 1, 2, 1, 1, 1, 1],\r\n                [1, 1, 3, 1, 0, 1, 1, 1, 1, 1],\r\n                [1, 1, 3, 0, 0, 0, 1, 1, 1, 1],\r\n                [1, 1, 1, 1, 0, 0, 1, 1, 1, 1],\r\n                [1, 1, 1, 1, 2, 2, 2, 4, 4, 1],\r\n                [1, 1, 1, 1, 1, 2, 1, 1, 1, 1],\r\n                [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n                [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n                [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],\r\n                [1, 1, 1, 1, 2, 2, 2, 1, 1, 1],\r\n                [1, 1, 1, 1, 1, 2, 1, 1, 1, 1],\r\n                [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n                [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n            ],\r\n        steps: 6,\r\n    },\r\n    {\r\n        grids: [\r\n            [1, 1, 1, 3, 1, 1, 1, 1, 1, 1],\r\n            [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n            [1, 3, 3, 1, 1, 1, 1, 1, 1, 1],\r\n            [3, 1, 3, 1, 1, 1, 2, 1, 1, 1],\r\n            [1, 1, 1, 1, 1, 2, 2, 1, 1, 1],\r\n            [1, 1, 3, 1, 2, 2, 2, 1, 1, 1],\r\n            [1, 1, 3, 1, 1, 2, 1, 1, 1, 1],\r\n            [1, 1, 3, 0, 0, 1, 1, 1, 1, 1],\r\n            [1, 1, 3, 0, 0, 0, 1, 1, 1, 1],\r\n            [1, 1, 1, 1, 0, 0, 1, 1, 1, 1],\r\n            [1, 1, 1, 1, 2, 2, 2, 4, 4, 1],\r\n            [1, 1, 1, 1, 1, 2, 1, 1, 1, 1],\r\n            [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n            [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],\r\n            [1, 1, 1, 1, 2, 2, 2, 1, 1, 1],\r\n            [1, 1, 1, 1, 1, 2, 1, 1, 1, 1],\r\n            [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n            [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n            [1, 1, 3, 1, 1, 6, 6, 1, 1, 1],\r\n            [1, 1, 3, 5, 5, 5, 5, 1, 1, 1],\r\n            [1, 1, 1, 1, 1, 6, 6, 1, 1, 1],\r\n        ],\r\n        steps: 5,\r\n    }\r\n]\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/example/grids.js","// const Kami = require('../kami');\r\nimport Kami from '../kami';\r\nimport gridsData from './grids';\r\n\r\nlet gridsIndex = 0;\r\n\r\nfunction initPage () {\r\n    let grids = gridsData[gridsIndex].grids;\r\n    let steps = gridsData[gridsIndex].steps;\r\n\r\n    const kami = new Kami({\r\n        grids,\r\n    });\r\n\r\n    const canvasContainerEl = document.querySelector('#canvas-wrapper');\r\n    const colorsContainerEl = document.querySelector('#colors-wrapper');\r\n    const tipContainerEl = document.querySelector('#tips-wrapper');\r\n\r\n    canvasContainerEl.innerHTML = `<canvas width=\"300\" height=\"400\"></canvas>`;\r\n\r\n    colorsContainerEl.innerHTML = '';\r\n    kami.types.forEach(type => {\r\n        colorsContainerEl.innerHTML +=\r\n            `<span\r\n            data-type=\"${type}\" \r\n            class=\"color\"\r\n            style=\"background: ${kami.colors[type]}; border: 3px solid ${kami.lines[type]}\"\r\n        ></span>`\r\n    });\r\n\r\n    tipContainerEl.innerHTML = `<div>请在${steps}步之内完成</div>`;\r\n\r\n    let curType;\r\n    let colorsEl = [].slice.call(colorsContainerEl.querySelectorAll('[data-type]'));\r\n    colorsEl.forEach(el => {\r\n        el.addEventListener('click', function (e) {\r\n            colorsEl.forEach(el => {\r\n                el.classList.remove('selected');\r\n            });\r\n            this.classList.add('selected');\r\n            curType = +this.dataset.type;\r\n        });\r\n    });\r\n    colorsContainerEl.querySelector('[data-type]').click();\r\n\r\n\r\n    const canvasEl = canvasContainerEl.querySelector('canvas');\r\n\r\n    canvasEl.addEventListener('click', e => {\r\n\r\n        let node = kami.getNodeByOffset(e.offsetX / canvasEl.offsetWidth, e.offsetY / canvasEl.offsetHeight);\r\n        kami.tap(node, curType, {\r\n            onEnd ({ result, tapCount }) {\r\n                if (result) {\r\n                    gridsIndex++;\r\n                    if (gridsIndex >= gridsData.length) {\r\n                        alert(`已完成所有`);\r\n                        return;\r\n                    }\r\n                    alert(`完成`);\r\n                    initPage();\r\n                } else if (tapCount > steps) {\r\n                    alert(`失败`);\r\n                    kami.reset();\r\n                }\r\n            },\r\n            delay: 100,\r\n        });\r\n    });\r\n\r\n    kami.mount(canvasEl);\r\n}\r\n\r\ninitPage();\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/example/index.js","import Kami from './kami-extend';\r\n\r\nexport default Kami;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/kami/index.js","import KamiCore from './kami-core';\r\n\r\nexport default class Kami extends KamiCore {\r\n    // 挂载到canvas并自动渲染\r\n    mount (\r\n        canvas,\r\n        {\r\n            colors,\r\n            lines,\r\n        } = {}) {\r\n        this._canvas = canvas;\r\n        colors = colors || this.colors || Kami.defaultColors;\r\n        lines = lines || this.lines || Kami.defaultLines;\r\n        this.setStyles({ colors, lines });\r\n        this.render();\r\n    }\r\n\r\n    // 改变节点样式\r\n    setStyles ({ node, colors, lines }) {\r\n        this.colors = colors || this.colors;\r\n        this.lines = lines || this.lines;\r\n        if (node) {\r\n            node.color = this.colors[node.type] || '';\r\n            node.line = typeof this.lines === 'object' ? this.lines[node.type] : (node.type ? this.lines : '');\r\n        } else {\r\n            this.nodeGrids.forEach(row => {\r\n                row.forEach(node => {\r\n                    node.color = this.colors[node.type] || '';\r\n                    node.line = typeof this.lines === 'object' ? this.lines[node.type] : (node.type ? this.lines : '');\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    // 渲染到canvas\r\n    render () {\r\n        if (!this._canvas) return;\r\n        const { nodeGrids, _canvas } = this;\r\n\r\n        const canvasWidth = _canvas.width;\r\n        const canvasHeight = _canvas.height;\r\n        const ctx = _canvas.getContext('2d');\r\n        const gridXLen = nodeGrids[0].length;\r\n        const gridYLen = nodeGrids.length;\r\n        const nodeWidth = canvasWidth / gridXLen;\r\n        const nodeHeight = canvasHeight / ((gridYLen -1) / 2) / 2;\r\n        ctx.clearRect(0, 0, canvasWidth, canvasHeight);\r\n        nodeGrids.forEach((rowData, y) => {\r\n            rowData.forEach((node, x) => {\r\n                let reverse = (x + y) & 1;\r\n                ctx.beginPath();\r\n                if (!reverse) {\r\n                    ctx.moveTo(nodeWidth * x, nodeHeight * (y - 1));\r\n                    ctx.lineTo(nodeWidth * (x + 1), nodeHeight * y);\r\n                    ctx.lineTo(nodeWidth * x, nodeHeight * (y + 1));\r\n                    ctx.lineTo(nodeWidth * x, nodeHeight * (y - 1));\r\n                } else {\r\n                    ctx.moveTo(nodeWidth * x, nodeHeight * y);\r\n                    ctx.lineTo(nodeWidth * (x + 1), nodeHeight * (y - 1));\r\n                    ctx.lineTo(nodeWidth * (x + 1), nodeHeight * (y + 1));\r\n                    ctx.lineTo(nodeWidth * x, nodeHeight * y);\r\n                }\r\n\r\n                ctx.fillStyle = node.color;\r\n                node.color && ctx.fill();\r\n                ctx.strokeStyle = node.line;\r\n                node.line && ctx.stroke();\r\n                ctx.closePath();\r\n            });\r\n        });\r\n    }\r\n\r\n    // 根据坐标获取节点\r\n    getNodeByOffset (percentX, percentY) {\r\n        const areaWidth = 1 / this.nodeGrids[0].length;\r\n        const areaHeight = (1 / ((this.nodeGrids.length - 1)));\r\n\r\n        let areaX = percentX / areaWidth | 0;\r\n        let areaOffsetXPercent = percentX / areaWidth - areaX;\r\n        let areaY = percentY / areaHeight | 0;\r\n        let areaOffsetYPercent = 1 - (percentY / areaHeight - areaY);\r\n\r\n        let isUpHalf = (areaX + areaY) & 1 ? (1 - areaOffsetXPercent) < areaOffsetYPercent : areaOffsetXPercent < areaOffsetYPercent;\r\n\r\n        let x = areaX;\r\n        let y = isUpHalf ? areaY : areaY + 1;\r\n        return this.nodeGrids[y][x];\r\n    }\r\n}\r\n\r\nmodule.exports = Kami;\n\n\n// WEBPACK FOOTER //\n// ./src/kami/kami-extend.js","import Node from './node';\r\nimport { defaultLines, defaultColors } from './config';\r\n\r\nfunction initData () {\r\n    const nodeTypeMap = {};\r\n    const nodeGrids = this._originGrids.map(row => row.map(nodeType => {\r\n        nodeTypeMap[nodeType] = true;\r\n        return new Node(nodeType);\r\n    }));\r\n\r\n    Object.defineProperties(nodeGrids, {\r\n        getNode: {\r\n            value (x, y) {\r\n                return this[y] && this[y][x] || null;\r\n            },\r\n            enumerable: false,\r\n        }\r\n    });\r\n\r\n    // 处理各节点的链接关系\r\n    nodeGrids.forEach((row, y) => {\r\n        row.forEach((node, x) => {\r\n            node.link(nodeGrids.getNode(x, y - 1), nodeGrids.getNode(x, y + 1), nodeGrids.getNode(x + ((x + y) & 1 ? 1 : -1), y));\r\n        });\r\n    });\r\n\r\n    this.nodeGrids = nodeGrids;\r\n    this._tapCount = 0;\r\n    this.types = Object.keys(nodeTypeMap).map(typeStr => +typeStr).filter(type => type);\r\n\r\n    if (this._canvas) {\r\n        typeof this.mount === 'function' && this.mount(this._canvas);\r\n    }\r\n}\r\n\r\nexport default class KamiCore {\r\n    constructor ({\r\n                     canvas = null,\r\n                     grids,\r\n                     colors = KamiCore.defaultColors,\r\n                     lines = KamiCore.defaultLines,\r\n                 } = {}) {\r\n        if (!grids || !grids[0]) {\r\n            throw new Error('please use correct grids');\r\n        }\r\n\r\n        this._originGrids = grids;\r\n        this._canvas = canvas;\r\n        this.colors = colors;\r\n        this.lines = lines;\r\n        initData.call(this);\r\n    }\r\n\r\n    static defaultLines = defaultLines;\r\n    static defaultColors = defaultColors;\r\n\r\n    // 触发某节点的改变\r\n    tap (node, targetType, { delay, onEnd } = {}) {\r\n        const originalType = node.type;\r\n        if (targetType === originalType) return;\r\n\r\n        this._tapCount++;\r\n        let traveledNodes = new WeakSet();　// 已遍历过的节点\r\n        let nodes = new Set([node]);　// 需要处理的当前层节点\r\n\r\n        // 以BFS算法遍历各节点进行处理\r\n        const spread = () => {\r\n            let nextNodes = new Set();\r\n            nodes.forEach(node => {\r\n                traveledNodes.add(node);\r\n                node.type = targetType;\r\n                typeof this.setStyles === 'function' && this.setStyles({ node });\r\n                for (let linkNode of node._linkNodes) {\r\n                    if (!traveledNodes.has(linkNode) && linkNode.type === originalType) {\r\n                        nextNodes.add(linkNode);\r\n                    }\r\n                }\r\n            });\r\n            nodes = nextNodes;\r\n            if (nodes.size) {\r\n                if (delay) {\r\n                    delay = delay / 10 * 9;\r\n                    typeof this.render === 'function' && this.render();\r\n                    setTimeout(spread, delay);\r\n                } else {\r\n                    spread();\r\n                }\r\n            } else {\r\n                typeof this.render === 'function' && this.render();\r\n                onEnd && onEnd({\r\n                    result: this.checkConsistency(),\r\n                    tapCount: this._tapCount,\r\n                });\r\n            }\r\n        };\r\n        spread();\r\n    }\r\n\r\n    reset () {\r\n        initData.call(this);\r\n    }\r\n\r\n    // 检查结果\r\n    checkConsistency () {\r\n        let type;\r\n        for (let row of this.nodeGrids) {\r\n            for (let node of row) {\r\n                if (!type) type = node.type;\r\n                if (node.type && node.type !== type) return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n\r\nmodule.exports = KamiCore;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/kami/kami-core.js"],"sourceRoot":""}