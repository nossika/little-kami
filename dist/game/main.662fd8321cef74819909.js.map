{"version":3,"sources":["webpack:///main.662fd8321cef74819909.js","webpack:///./src/kami/node.js","webpack:///./src/kami/config.js","webpack:///./src/game.js","webpack:///./src/kami/index.js","webpack:///./src/kami/kami-extend.js","webpack:///./src/kami/kami-core.js"],"names":["webpackJsonp","125","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","undefined","_set","_set2","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","Node","type","this","color","line","_linkNodes","key","_this","_len","arguments","length","nodes","Array","_key","filter","node","forEach","has","add","_this2","_len2","_key2","delete","126","defaultLines","1","2","3","4","defaultColors","64","Kami","canvas","document","querySelector","curColor","slice","call","querySelectorAll","el","addEventListener","e","dataset","console","log","click","grids","kami","mount","getNodeByOffset","offsetX","offsetWidth","offsetY","offsetHeight","tap","onEnd","result","alert","delay","65","_kamiExtend","_kamiExtend2","66","_typeof2","_typeof3","_getPrototypeOf","_getPrototypeOf2","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_kamiCore","_kamiCore2","_KamiCore","__proto__","apply","_ref","colors","lines","_canvas","_colors","_lines","setStyles","render","_ref2","nodeGrids","row","canvasWidth","width","canvasHeight","height","ctx","getContext","gridXLen","gridYLen","nodeWidth","nodeHeight","clearRect","rowData","y","x","reverse","beginPath","moveTo","lineTo","fillStyle","fill","strokeStyle","stroke","closePath","percentX","percentY","areaWidth","areaHeight","areaX","areaOffsetXPercent","areaY","areaOffsetYPercent","isUpHalf","99","_class","_temp","_getIterator2","_getIterator3","_weakSet","_weakSet2","_defineProperties","_defineProperties2","_node","_node2","_config","KamiCore","_ref$colors","_ref$lines","map","nodeType","getNode","enumerable","link","targetType","originalType","traveledNodes","spread","nextNodes","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","next","done","linkNode","err","return","size","setTimeout","checkConsistency","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3"],"mappings":"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","file":"main.662fd8321cef74819909.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ 125:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = undefined;\n\nvar _set = __webpack_require__(59);\n\nvar _set2 = _interopRequireDefault(_set);\n\nvar _classCallCheck2 = __webpack_require__(40);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(41);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Node = function () {\n    function Node(type) {\n        (0, _classCallCheck3.default)(this, Node);\n\n        this.type = type;\n        this.color = '';\n        this.line = '';\n        this._linkNodes = new _set2.default();\n    }\n\n    (0, _createClass3.default)(Node, [{\n        key: 'link',\n        value: function link() {\n            var _this = this;\n\n            if (!this.type) return;\n\n            for (var _len = arguments.length, nodes = Array(_len), _key = 0; _key < _len; _key++) {\n                nodes[_key] = arguments[_key];\n            }\n\n            nodes.filter(function (node) {\n                return node && node instanceof Node && node.type;\n            }).forEach(function (node) {\n                if (_this._linkNodes.has(node)) return; // if node already linked, do nothing\n                _this._linkNodes.add(node);\n                node._linkNodes.add(_this);\n            });\n        }\n    }, {\n        key: 'unlink',\n        value: function unlink() {\n            var _this2 = this;\n\n            for (var _len2 = arguments.length, nodes = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                nodes[_key2] = arguments[_key2];\n            }\n\n            nodes.filter(function (node) {\n                return node && node instanceof Node && node.type;\n            }).forEach(function (node) {\n                _this2._linkNodes.delete(node);\n                node._linkNodes.delete(_this2);\n            });\n        }\n    }]);\n    return Node;\n}();\n\nexports.default = Node;\n\n/***/ }),\n\n/***/ 126:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar defaultLines = exports.defaultLines = {\n    '1': 'rgba(183,235,143,.15)',\n    '2': 'rgba(145,213,255,.15)',\n    '3': 'rgba(255,229,143,.15)',\n    '4': 'rgba(255,163,158,.15)'\n};\n\nvar defaultColors = exports.defaultColors = {\n    '1': '#f6ffed',\n    '2': '#e6f7ff',\n    '3': '#fffbe6',\n    '4': '#fff1f0'\n};\n\n/***/ }),\n\n/***/ 64:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar Kami = __webpack_require__(65);\n\nvar canvas = document.querySelector('#canvas');\n\nvar curColor = void 0;\n[].slice.call(document.querySelectorAll('#colors [data-color]')).forEach(function (el) {\n    el.addEventListener('click', function (e) {\n        curColor = +el.dataset.color;\n        console.log('curColor', curColor);\n    });\n});\ndocument.querySelector('#colors [data-color]').click();\nvar grids = [[1, 1, 1, 3, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 3, 3, 1, 1, 1, 1, 1, 1, 1], [3, 1, 3, 1, 1, 1, 2, 1, 1, 1], [1, 1, 1, 1, 1, 2, 2, 1, 1, 1], [1, 1, 3, 1, 2, 2, 2, 1, 1, 1], [1, 1, 3, 1, 1, 2, 1, 1, 1, 1], [1, 1, 3, 0, 0, 1, 1, 1, 1, 1], [1, 1, 3, 0, 0, 0, 1, 1, 1, 1], [1, 1, 1, 1, 0, 0, 1, 1, 1, 1], [1, 1, 1, 1, 2, 2, 2, 4, 4, 1], [1, 1, 1, 1, 1, 2, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 2, 2, 2, 1, 1, 1], [1, 1, 1, 1, 1, 2, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 3, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]];\n\nvar kami = new Kami({\n    grids: grids\n});\n\nkami.mount(canvas);\n\ncanvas.addEventListener('click', function (e) {\n    var node = kami.getNodeByOffset(e.offsetX / canvas.offsetWidth, e.offsetY / canvas.offsetHeight);\n    kami.tap(node, curColor, {\n        onEnd: function onEnd(result) {\n            console.log(result);\n            if (result) {\n                alert('win');\n            }\n        },\n\n        delay: 100\n    });\n});\n\nconsole.log(kami);\n\n/***/ }),\n\n/***/ 65:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _kamiExtend = __webpack_require__(66);\n\nvar _kamiExtend2 = _interopRequireDefault(_kamiExtend);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = _kamiExtend2.default;\n\n/***/ }),\n\n/***/ 66:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = undefined;\n\nvar _typeof2 = __webpack_require__(22);\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nvar _getPrototypeOf = __webpack_require__(83);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(40);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(41);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(90);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(91);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _kamiCore = __webpack_require__(99);\n\nvar _kamiCore2 = _interopRequireDefault(_kamiCore);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Kami = function (_KamiCore) {\n    (0, _inherits3.default)(Kami, _KamiCore);\n\n    function Kami() {\n        (0, _classCallCheck3.default)(this, Kami);\n        return (0, _possibleConstructorReturn3.default)(this, (Kami.__proto__ || (0, _getPrototypeOf2.default)(Kami)).apply(this, arguments));\n    }\n\n    (0, _createClass3.default)(Kami, [{\n        key: 'mount',\n        value: function mount(canvas) {\n            var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n                colors = _ref.colors,\n                lines = _ref.lines;\n\n            this._canvas = canvas;\n            colors = colors || this._colors || Kami.defaultColors;\n            lines = lines || this._lines || Kami.defaultLines;\n            this.setStyles({ colors: colors, lines: lines });\n            this.render();\n        }\n    }, {\n        key: 'setStyles',\n        value: function setStyles(_ref2) {\n            var _this2 = this;\n\n            var node = _ref2.node,\n                colors = _ref2.colors,\n                lines = _ref2.lines;\n\n            this._colors = colors || this._colors;\n            this._lines = lines || this._lines;\n            if (node) {\n                node.color = this._colors[node.type] || '';\n                node.line = (0, _typeof3.default)(this._lines) === 'object' ? this._lines[node.type] : node.type ? this._lines : '';\n            } else {\n                this.nodeGrids.forEach(function (row) {\n                    row.forEach(function (node) {\n                        node.color = _this2._colors[node.type] || '';\n                        node.line = (0, _typeof3.default)(_this2._lines) === 'object' ? _this2._lines[node.type] : node.type ? _this2._lines : '';\n                    });\n                });\n            }\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            if (!this._canvas) return;\n            var nodeGrids = this.nodeGrids,\n                _canvas = this._canvas;\n\n\n            var canvasWidth = _canvas.width;\n            var canvasHeight = _canvas.height;\n            var ctx = _canvas.getContext('2d');\n            var gridXLen = nodeGrids[0].length;\n            var gridYLen = nodeGrids.length;\n            var nodeWidth = canvasWidth / gridXLen;\n            var nodeHeight = canvasHeight / ((gridYLen - 1) / 2) / 2;\n            ctx.clearRect(0, 0, canvasWidth, canvasHeight);\n            nodeGrids.forEach(function (rowData, y) {\n                rowData.forEach(function (node, x) {\n                    var reverse = x + y & 1;\n                    ctx.beginPath();\n                    if (!reverse) {\n                        ctx.moveTo(nodeWidth * x, nodeHeight * (y - 1));\n                        ctx.lineTo(nodeWidth * (x + 1), nodeHeight * y);\n                        ctx.lineTo(nodeWidth * x, nodeHeight * (y + 1));\n                        ctx.lineTo(nodeWidth * x, nodeHeight * (y - 1));\n                    } else {\n                        ctx.moveTo(nodeWidth * x, nodeHeight * y);\n                        ctx.lineTo(nodeWidth * (x + 1), nodeHeight * (y - 1));\n                        ctx.lineTo(nodeWidth * (x + 1), nodeHeight * (y + 1));\n                        ctx.lineTo(nodeWidth * x, nodeHeight * y);\n                    }\n\n                    ctx.fillStyle = node.color;\n                    node.color && ctx.fill();\n                    ctx.strokeStyle = node.line;\n                    node.line && ctx.stroke();\n                    ctx.closePath();\n                });\n            });\n        }\n    }, {\n        key: 'getNodeByOffset',\n        value: function getNodeByOffset(percentX, percentY) {\n            var areaWidth = 1 / this.nodeGrids[0].length;\n            var areaHeight = 1 / (this.nodeGrids.length - 1);\n\n            var areaX = percentX / areaWidth | 0;\n            var areaOffsetXPercent = percentX / areaWidth - areaX;\n            var areaY = percentY / areaHeight | 0;\n            var areaOffsetYPercent = 1 - (percentY / areaHeight - areaY);\n\n            var isUpHalf = areaX + areaY & 1 ? 1 - areaOffsetXPercent < areaOffsetYPercent : areaOffsetXPercent < areaOffsetYPercent;\n\n            var x = areaX;\n            var y = isUpHalf ? areaY : areaY + 1;\n            return this.nodeGrids[y][x];\n        }\n    }]);\n    return Kami;\n}(_kamiCore2.default);\n\nexports.default = Kami;\n\n/***/ }),\n\n/***/ 99:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = undefined;\n\nvar _getIterator2 = __webpack_require__(100);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _set = __webpack_require__(59);\n\nvar _set2 = _interopRequireDefault(_set);\n\nvar _weakSet = __webpack_require__(116);\n\nvar _weakSet2 = _interopRequireDefault(_weakSet);\n\nvar _defineProperties = __webpack_require__(122);\n\nvar _defineProperties2 = _interopRequireDefault(_defineProperties);\n\nvar _classCallCheck2 = __webpack_require__(40);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(41);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _class, _temp;\n\nvar _node = __webpack_require__(125);\n\nvar _node2 = _interopRequireDefault(_node);\n\nvar _config = __webpack_require__(126);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar KamiCore = (_temp = _class = function () {\n    function KamiCore() {\n        var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n            canvas = _ref.canvas,\n            grids = _ref.grids,\n            _ref$colors = _ref.colors,\n            colors = _ref$colors === undefined ? KamiCore.defaultColors : _ref$colors,\n            _ref$lines = _ref.lines,\n            lines = _ref$lines === undefined ? KamiCore.defaultLines : _ref$lines;\n\n        (0, _classCallCheck3.default)(this, KamiCore);\n\n        var nodeGrids = grids.map(function (row) {\n            return row.map(function (nodeType) {\n                return new _node2.default(nodeType);\n            });\n        });\n\n        (0, _defineProperties2.default)(nodeGrids, {\n            getNode: {\n                value: function value(x, y) {\n                    return this[y] && this[y][x] || null;\n                },\n\n                enumerable: false\n            }\n        });\n\n        // 处理各节点的链接关系\n        nodeGrids.forEach(function (row, y) {\n            row.forEach(function (node, x) {\n                node.link(nodeGrids.getNode(x, y - 1), nodeGrids.getNode(x, y + 1), nodeGrids.getNode(x + (x + y & 1 ? 1 : -1), y));\n            });\n        });\n\n        this.nodeGrids = nodeGrids;\n        if (canvas) {\n            this.mount(canvas, { colors: colors, lines: lines });\n        }\n    }\n\n    (0, _createClass3.default)(KamiCore, [{\n        key: 'tap',\n\n\n        // 触发某节点的改变\n        value: function tap(node, targetType) {\n            var _this = this;\n\n            var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n                delay = _ref2.delay,\n                onEnd = _ref2.onEnd;\n\n            var originalType = node.type;\n            var traveledNodes = new _weakSet2.default(); // 已遍历过的节点\n            var nodes = new _set2.default([node]); // 需要处理的当前层节点\n\n            // 以BFS算法遍历各节点进行处理\n            var spread = function spread() {\n                var nextNodes = new _set2.default();\n                nodes.forEach(function (node) {\n                    traveledNodes.add(node);\n                    node.type = targetType;\n                    typeof _this.setStyles === 'function' && _this.setStyles({ node: node });\n                    var _iteratorNormalCompletion = true;\n                    var _didIteratorError = false;\n                    var _iteratorError = undefined;\n\n                    try {\n                        for (var _iterator = (0, _getIterator3.default)(node._linkNodes), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                            var linkNode = _step.value;\n\n                            if (!traveledNodes.has(linkNode) && linkNode.type === originalType) {\n                                nextNodes.add(linkNode);\n                            }\n                        }\n                    } catch (err) {\n                        _didIteratorError = true;\n                        _iteratorError = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion && _iterator.return) {\n                                _iterator.return();\n                            }\n                        } finally {\n                            if (_didIteratorError) {\n                                throw _iteratorError;\n                            }\n                        }\n                    }\n                });\n                nodes = nextNodes;\n                if (nodes.size) {\n                    if (delay) {\n                        delay = delay / 10 * 9;\n                        typeof _this.render === 'function' && _this.render();\n                        setTimeout(spread, delay);\n                    } else {\n                        spread();\n                    }\n                } else {\n                    typeof _this.render === 'function' && _this.render();\n                    onEnd && onEnd(_this.checkConsistency());\n                }\n            };\n            spread();\n        }\n\n        // 检查连续性\n\n    }, {\n        key: 'checkConsistency',\n        value: function checkConsistency() {\n            var type = void 0;\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = (0, _getIterator3.default)(this.nodeGrids), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var row = _step2.value;\n                    var _iteratorNormalCompletion3 = true;\n                    var _didIteratorError3 = false;\n                    var _iteratorError3 = undefined;\n\n                    try {\n                        for (var _iterator3 = (0, _getIterator3.default)(row), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                            var node = _step3.value;\n\n                            if (!type) type = node.type;\n                            if (node.type && node.type !== type) return false;\n                        }\n                    } catch (err) {\n                        _didIteratorError3 = true;\n                        _iteratorError3 = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                                _iterator3.return();\n                            }\n                        } finally {\n                            if (_didIteratorError3) {\n                                throw _iteratorError3;\n                            }\n                        }\n                    }\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n\n            return true;\n        }\n    }]);\n    return KamiCore;\n}(), _class.defaultLines = _config.defaultLines, _class.defaultColors = _config.defaultColors, _temp);\nexports.default = KamiCore;\n\n/***/ })\n\n},[64]);\n\n\n// WEBPACK FOOTER //\n// main.662fd8321cef74819909.js","export default class Node {\r\n    constructor (type) {\r\n        this.type = type;\r\n        this.color = '';\r\n        this.line = '';\r\n        this._linkNodes = new Set();\r\n    }\r\n\r\n    link (...nodes) {\r\n        if (!this.type) return;\r\n        nodes.filter(node => node && node instanceof Node && node.type).forEach(node => {\r\n            if (this._linkNodes.has(node)) return; // if node already linked, do nothing\r\n            this._linkNodes.add(node);\r\n            node._linkNodes.add(this);\r\n        });\r\n    }\r\n    unlink (...nodes) {\r\n        nodes.filter(node => node && node instanceof Node && node.type).forEach(node => {\r\n            this._linkNodes.delete(node);\r\n            node._linkNodes.delete(this);\r\n        });\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/kami/node.js","export const defaultLines = {\r\n    '1': 'rgba(183,235,143,.15)',\r\n    '2': 'rgba(145,213,255,.15)',\r\n    '3': 'rgba(255,229,143,.15)',\r\n    '4': 'rgba(255,163,158,.15)',\r\n};\r\n\r\nexport const defaultColors = {\r\n    '1': '#f6ffed',\r\n    '2': '#e6f7ff',\r\n    '3': '#fffbe6',\r\n    '4': '#fff1f0',\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/kami/config.js","const Kami = require('./kami');\r\n\r\nconst canvas = document.querySelector('#canvas');\r\n\r\nlet curColor;\r\n[].slice.call(document.querySelectorAll('#colors [data-color]')).forEach(el => {\r\n    el.addEventListener('click', e => {\r\n        curColor = +el.dataset.color;\r\n        console.log('curColor', curColor);\r\n    });\r\n});\r\ndocument.querySelector('#colors [data-color]').click();\r\nlet grids = [\r\n    [1, 1, 1, 3, 1, 1, 1, 1, 1, 1],\r\n    [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n    [1, 3, 3, 1, 1, 1, 1, 1, 1, 1],\r\n    [3, 1, 3, 1, 1, 1, 2, 1, 1, 1],\r\n    [1, 1, 1, 1, 1, 2, 2, 1, 1, 1],\r\n    [1, 1, 3, 1, 2, 2, 2, 1, 1, 1],\r\n    [1, 1, 3, 1, 1, 2, 1, 1, 1, 1],\r\n    [1, 1, 3, 0, 0, 1, 1, 1, 1, 1],\r\n    [1, 1, 3, 0, 0, 0, 1, 1, 1, 1],\r\n    [1, 1, 1, 1, 0, 0, 1, 1, 1, 1],\r\n    [1, 1, 1, 1, 2, 2, 2, 4, 4, 1],\r\n    [1, 1, 1, 1, 1, 2, 1, 1, 1, 1],\r\n    [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n    [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],\r\n    [1, 1, 1, 1, 2, 2, 2, 1, 1, 1],\r\n    [1, 1, 1, 1, 1, 2, 1, 1, 1, 1],\r\n    [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n    [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n    [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n    [1, 1, 3, 1, 1, 1, 1, 1, 1, 1],\r\n    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],\r\n];\r\n\r\nlet kami = new Kami({\r\n    grids\r\n});\r\n\r\nkami.mount(canvas);\r\n\r\ncanvas.addEventListener('click', e => {\r\n    let node = kami.getNodeByOffset(e.offsetX / canvas.offsetWidth, e.offsetY / canvas.offsetHeight);\r\n    kami.tap(node, curColor, {\r\n        onEnd (result) {\r\n            console.log(result);\r\n            if (result) {\r\n                alert('win');\r\n            }\r\n        },\r\n        delay: 100,\r\n    });\r\n});\r\n\r\nconsole.log(kami);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/game.js","import Kami from './kami-extend';\r\n\r\nmodule.exports = Kami;\n\n\n// WEBPACK FOOTER //\n// ./src/kami/index.js","import KamiCore from './kami-core';\r\n\r\nexport default class Kami extends KamiCore {\r\n    mount (\r\n        canvas,\r\n        {\r\n            colors,\r\n            lines,\r\n        } = {}) {\r\n        this._canvas = canvas;\r\n        colors = colors || this._colors || Kami.defaultColors;\r\n        lines = lines || this._lines || Kami.defaultLines;\r\n        this.setStyles({ colors, lines });\r\n        this.render();\r\n    }\r\n\r\n    setStyles ({ node, colors, lines }) {\r\n        this._colors = colors || this._colors;\r\n        this._lines = lines || this._lines;\r\n        if (node) {\r\n            node.color = this._colors[node.type] || '';\r\n            node.line = typeof this._lines === 'object' ? this._lines[node.type] : (node.type ? this._lines : '');\r\n        } else {\r\n            this.nodeGrids.forEach(row => {\r\n                row.forEach(node => {\r\n                    node.color = this._colors[node.type] || '';\r\n                    node.line = typeof this._lines === 'object' ? this._lines[node.type] : (node.type ? this._lines : '');\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    render () {\r\n        if (!this._canvas) return;\r\n        const { nodeGrids, _canvas } = this;\r\n\r\n        const canvasWidth = _canvas.width;\r\n        const canvasHeight = _canvas.height;\r\n        const ctx = _canvas.getContext('2d');\r\n        const gridXLen = nodeGrids[0].length;\r\n        const gridYLen = nodeGrids.length;\r\n        const nodeWidth = canvasWidth / gridXLen;\r\n        const nodeHeight = canvasHeight / ((gridYLen -1) / 2) / 2;\r\n        ctx.clearRect(0, 0, canvasWidth, canvasHeight);\r\n        nodeGrids.forEach((rowData, y) => {\r\n            rowData.forEach((node, x) => {\r\n                let reverse = (x + y) & 1;\r\n                ctx.beginPath();\r\n                if (!reverse) {\r\n                    ctx.moveTo(nodeWidth * x, nodeHeight * (y - 1));\r\n                    ctx.lineTo(nodeWidth * (x + 1), nodeHeight * y);\r\n                    ctx.lineTo(nodeWidth * x, nodeHeight * (y + 1));\r\n                    ctx.lineTo(nodeWidth * x, nodeHeight * (y - 1));\r\n                } else {\r\n                    ctx.moveTo(nodeWidth * x, nodeHeight * y);\r\n                    ctx.lineTo(nodeWidth * (x + 1), nodeHeight * (y - 1));\r\n                    ctx.lineTo(nodeWidth * (x + 1), nodeHeight * (y + 1));\r\n                    ctx.lineTo(nodeWidth * x, nodeHeight * y);\r\n                }\r\n\r\n                ctx.fillStyle = node.color;\r\n                node.color && ctx.fill();\r\n                ctx.strokeStyle = node.line;\r\n                node.line && ctx.stroke();\r\n                ctx.closePath();\r\n            });\r\n        });\r\n    }\r\n\r\n    getNodeByOffset (percentX, percentY) {\r\n        const areaWidth = 1 / this.nodeGrids[0].length;\r\n        const areaHeight = (1 / ((this.nodeGrids.length - 1)));\r\n\r\n        let areaX = percentX / areaWidth | 0;\r\n        let areaOffsetXPercent = percentX / areaWidth - areaX;\r\n        let areaY = percentY / areaHeight | 0;\r\n        let areaOffsetYPercent = 1 - (percentY / areaHeight - areaY);\r\n\r\n        let isUpHalf = (areaX + areaY) & 1 ? (1 - areaOffsetXPercent) < areaOffsetYPercent : areaOffsetXPercent < areaOffsetYPercent;\r\n\r\n        let x = areaX;\r\n        let y = isUpHalf ? areaY : areaY + 1;\r\n        return this.nodeGrids[y][x];\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/kami/kami-extend.js","import Node from './node';\r\nimport { defaultLines, defaultColors } from './config';\r\n\r\nexport default class KamiCore {\r\n    constructor ({\r\n                     canvas,\r\n                     grids,\r\n                     colors = KamiCore.defaultColors,\r\n                     lines = KamiCore.defaultLines,\r\n                 } = {}) {\r\n        const nodeGrids = grids.map(row => row.map(nodeType => new Node(nodeType)));\r\n\r\n        Object.defineProperties(nodeGrids, {\r\n            getNode: {\r\n                value (x, y) {\r\n                    return this[y] && this[y][x] || null;\r\n                },\r\n                enumerable: false,\r\n            }\r\n        });\r\n\r\n        // 处理各节点的链接关系\r\n        nodeGrids.forEach((row, y) => {\r\n            row.forEach((node, x) => {\r\n                node.link(nodeGrids.getNode(x, y - 1), nodeGrids.getNode(x, y + 1), nodeGrids.getNode(x + ((x + y) & 1 ? 1 : -1), y));\r\n            });\r\n        });\r\n\r\n        this.nodeGrids = nodeGrids;\r\n        if (canvas) {\r\n            this.mount(canvas, { colors, lines });\r\n        }\r\n    }\r\n\r\n    static defaultLines = defaultLines;\r\n    static defaultColors = defaultColors;\r\n\r\n    // 触发某节点的改变\r\n    tap (node, targetType, { delay, onEnd } = {}) {\r\n        const originalType = node.type;\r\n        let traveledNodes = new WeakSet();　// 已遍历过的节点\r\n        let nodes = new Set([node]);　// 需要处理的当前层节点\r\n\r\n        // 以BFS算法遍历各节点进行处理\r\n        const spread = () => {\r\n            let nextNodes = new Set();\r\n            nodes.forEach(node => {\r\n                traveledNodes.add(node);\r\n                node.type = targetType;\r\n                typeof this.setStyles === 'function' && this.setStyles({ node });\r\n                for (let linkNode of node._linkNodes) {\r\n                    if (!traveledNodes.has(linkNode) && linkNode.type === originalType) {\r\n                        nextNodes.add(linkNode);\r\n                    }\r\n                }\r\n            });\r\n            nodes = nextNodes;\r\n            if (nodes.size) {\r\n                if (delay) {\r\n                    delay = delay / 10 * 9;\r\n                    typeof this.render === 'function' && this.render();\r\n                    setTimeout(spread, delay);\r\n                } else {\r\n                    spread();\r\n                }\r\n            } else {\r\n                typeof this.render === 'function' && this.render();\r\n                onEnd && onEnd(this.checkConsistency());\r\n            }\r\n        };\r\n        spread();\r\n    }\r\n\r\n    // 检查连续性\r\n    checkConsistency () {\r\n        let type;\r\n        for (let row of this.nodeGrids) {\r\n            for (let node of row) {\r\n                if (!type) type = node.type;\r\n                if (node.type && node.type !== type) return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/kami/kami-core.js"],"sourceRoot":""}